(()=>{"use strict";const e=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];let t=!1,n="celsius",o="hourly";function a(e){return 9*e/5+32}function i(e,t,n){let o;return console.log("future features"+t+n),n?n&&(o=e.timelines.hourly[t]):o=e.timelines.daily[t],o.precipitationProbabilityAvg>50&&o.rainIntensityAvg>.55?"Storm":o.precipitationProbabilityAvg>50&&o.rainIntensityAvg<.5?"Rain":o.cloudCoverAvg<25?"Clear":o.cloudCoverAvg>25&&o.cloudCoverAvg<50?"Partly Cloudy":o.precipitationProbabilityAvg>50&&o.snowIntensityAvg>0?"Snow":o.cloudCoverAvg>50?"Cloudy":"unknown"}function c(e,t){const n={Rain:{background:t?"night-rain.jpg":"rain.jpg",icon:t?"wi-night-rain.svg":"wi-day-rain.svg"},Clear:{background:t?"clearest-night.jpg":"clear.jpg",icon:t?"wi-night-clear.svg":"wi-day-sunny.svg"},Cloudy:{background:t?"night-cloudy.jpg":"cloudy.jpg",icon:t?"wi-night-cloudy.svg":"wi-cloudy.svg"},Snow:{background:t?"night-snow.jpg":"snow.jpg",icon:t?"wi-night-snow.svg":"wi-snow.svg"},Storm:{background:"storm.jpg",icon:t?"wi-night-storm-showers.svg":"wi-thunderstorm.svg"},"Partly Cloudy":{background:t?"night-partly.jpg":"partly-cloudy.jpg",icon:t?"wi-night-partly-cloudy.svg":"wi-day-sunny-overcast.svg"}};let o=n[e]||n.Clear;return{backgroundImage:`../src/images/backgrounds/${o.background}`,icon:`../src/images/weather-icons-master/svg/${o.icon}`}}const r=document.querySelector(".switch-input"),l=document.getElementById("location-input"),d=document.getElementById("magnifying"),s=document.getElementById("hourly-button"),u=document.getElementById("daily-button");let m="barcelona";const g={method:"GET",headers:{accept:"application/json"}};let y,h;async function p(e){try{const t=await fetch(`https://api.tomorrow.io/v4/weather/realtime?location=${e}&apikey=Myn196y0vihIZSTNpL5yNZ0gU0PBPdLY`,g),n=await t.json();y="weather",console.log("OBJ 1: "+t),await f(n,n.location.lat,n.location.lon)}catch(e){console.error(e)}}async function v(e){try{const t=await fetch(`https://api.tomorrow.io/v4/weather/forecast?location=${e}&apikey=Myn196y0vihIZSTNpL5yNZ0gU0PBPdLY`,g),n=await t.json();y="forecast",await f(n,n.location.lat,n.location.lon)}catch(e){console.error(e)}}async function f(r,l,d){try{const s=await fetch(`http://api.timezonedb.com/v2.1/get-time-zone?key=B4K4P9U2INY5&format=json&by=position&lat=${l}&lng=${d}`),u=await s.json(),g=u.formatted.substring(u.formatted.indexOf(":")-2,u.formatted.indexOf(":")+3);h=g,"weather"===y?(await function(o){console.log("createweatherresponse:"+o);const i=document.getElementById("content");i.innerHTML=" ";const r=document.createElement("div"),l=document.createElement("div"),d=document.createElement("div");l.classList.add("card-div1"),d.classList.add("card-div2"),r.classList.add("weathercard");const s=document.createElement("img");s.classList.add("weathericon");const u=new Date(o.data.time),m=document.createElement("h2");m.textContent="Today, "+e[u.getDay()];const g=document.createElement("h3");g.textContent=h;let y=Number(h.slice(0,2));console.log("Integ Hour"+y),t=y<6||y>20,console.log("isNight: "+t);const p=document.createElement("h1");let v=o.location.name;!1===isNaN(v.substring(0,v.indexOf(",")))?(console.log(Math.round(v.substring(0,v.indexOf(",")))),p.textContent=v.substring(o.location.name.indexOf(",")+2,v.indexOf(",",v.indexOf(",")+1))):p.textContent=v.substring(0,v.indexOf(","));const f=document.createElement("h2");f.style.fontSize="30px";const w=document.createElement("p");let b=o.data.values.temperature,C=3.6*o.data.values.windSpeed;"fahrenheit"===n&&(b=a(b),C/=1.609344),f.textContent=Math.round(b)+("fahrenheit"===n?"Fº":"Cº"),w.textContent="Wind Speed: "+Math.round(C)+("fahrenheit"===n?"Mph":"Km/h");let E=function(e){const{values:t}=e.data;return t.precipitationProbability>50&&t.rainIntensity>.55?"Storm":t.precipitationProbability>50&&t.rainIntensity<.5?"Rain":t.cloudCover<25?"Clear":t.cloudCover>25&&t.cloudCover<50?"Partly Cloudy":t.precipitationProbability>50&&t.snowIntensity>0?"Snow":t.cloudCover>50?"Cloudy":"unknown"}(o),x=c(E,t);s.src=x.icon,document.body.style.backgroundImage=`url('${x.backgroundImage}')`;const k=document.createElement("h2");k.textContent=E;const I=document.createElement("p");I.textContent="Uv Index: "+o.data.values.uvIndex;const j=document.createElement("p");j.textContent="Chances of Rain: "+o.data.values.precipitationProbability+"%";const L=document.createElement("p");return L.textContent="Humidity: "+o.data.values.humidity+"%",l.append(s,p,k,g,f),d.append(m,L,w,j,I),r.append(l,d),i.appendChild(r),r}(r),v(m)):"forecast"===y&&async function(t){console.log(t);const r=document.getElementById("forecast");r.innerHTML=" ";const l=document.createElement("div");if(l.classList.add("forecastcardsdiv"),"daily"===o)for(let o=0;o<5;o++){let r=document.createElement("div"),d=new Date(t.timelines.daily[o].time),s=document.createElement("p");s.textContent=e[d.getDay()],r.classList.add("forecastcard");let u=document.createElement("img"),m=document.createElement("p"),g=document.createElement("p"),y=c(i(t,o,!1),!1);u.src=y.icon;let h=t.timelines.daily[o].values.temperatureMax,p=t.timelines.daily[o].values.temperatureMin;"fahrenheit"===n&&(h=a(h),p=a(p)),g.textContent=Math.round(h)+("fahrenheit"===n?"Fº":"Cº"),futureDatMinTemp.textContent=Math.round(p)+("fahrenheit"===n?"Fº":"Cº"),r.append(s,u,m,g),l.appendChild(r)}else if("hourly"===o){let e=1,o=Number(h.toString().slice(0,2))+1;console.log("currenthournew:"+o);for(let r=0;r<6;r++){console.log(r);let d=document.createElement("div"),s=document.createElement("p");s.textContent=o+":00",d.classList.add("forecastcard");let u=document.createElement("img"),m=document.createElement("p"),g=c(i(t,e,!0),!1);u.src=g.icon;let y=t.timelines.hourly[e].values.temperature;if("fahrenheit"===n&&(y=a(y)),m.textContent=Math.round(y)+("fahrenheit"===n?"Fº":"Cº"),d.append(s,u,m),l.appendChild(d),e+=4,o<24&&(o+=4),o>=24)switch(o){case 24:o=0;break;case 25:o=1;break;case 26:o=2;break;case 27:o=3}}}r.appendChild(l)}(r)}catch(e){console.error(e)}}window.addEventListener("load",(()=>{p(m)})),d.addEventListener("click",(()=>(console.log("glass clicked"),m=l.value,p(m),m))),r.addEventListener("click",(()=>{n="fahrenheit",p(m)})),s.addEventListener("click",(()=>{"daily"===o&&(o="hourly",p(m))})),u.addEventListener("click",(()=>{"hourly"===o&&(o="daily",p(m))})),navigator.geolocation.getCurrentPosition((e=>{console.log(e),function(e){fetch(`https://us1.locationiq.com/v1/reverse?key=pk.f37b37fa95ad947d134bbcff6585b6d9&lat=${e.coords.latitude}&lon=${e.coords.longitude}&format=json`).then((e=>e.json())).then((function(e){return console.log(e),m=e.address.postcode,p(m),v(m),m})).catch((e=>console.log(e)))}(e)}),(e=>{console.log(e)}))})();