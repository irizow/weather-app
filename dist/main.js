(()=>{"use strict";const e={method:"GET",headers:{accept:"application/json"}};let t;async function n(n){try{const d=await fetch(`https://api.tomorrow.io/v4/weather/forecast?location=${n}&apikey=Myn196y0vihIZSTNpL5yNZ0gU0PBPdLY`,e),u=await d.json();await async function(e,n,d){try{const u=await fetch(`http://api.timezonedb.com/v2.1/get-time-zone?key=B4K4P9U2INY5&format=json&by=position&lat=${n}&lng=${d}`),m=await u.json(),g=m.formatted.substring(m.formatted.indexOf(":")-2,m.formatted.indexOf(":")+3);t=g,await function(e){console.log("createweatherresponse:"+e);const n=document.getElementById("content");n.innerHTML=" ";const c=document.createElement("div"),d=document.createElement("div"),u=document.createElement("div");d.classList.add("card-div1"),u.classList.add("card-div2"),c.classList.add("weathercard");const m=document.createElement("img");m.classList.add("weathericon");let g=e.timelines.daily[0];const h=new Date(g.time),y=document.createElement("h2");y.textContent="Today, "+o[h.getDay()];const p=document.createElement("h3");p.textContent=t;let v=Number(t.slice(0,2));console.log("Integ Hour"+v),a=v<6||v>20,console.log("isNight: "+a);const f=document.createElement("h1");let w=e.location.name;if(!1===isNaN(w.substring(0,w.indexOf(",")))){let e=w.split(","),t=e[1]+", "+e[2];f.textContent=t}else{let e=w.split(","),t=e[0]+", "+e[1];f.textContent=t}const b=document.createElement("h2");b.style.fontSize="30px";const E=document.createElement("p");let C=g.values.temperatureAvg,k=3.6*g.values.windSpeedAvg;"fahrenheit"===i&&(C=r(C),k/=1.609344),b.textContent=Math.round(C)+("fahrenheit"===i?"Fº":"Cº"),E.textContent="Wind Speed: "+Math.round(k)+("fahrenheit"===i?"Mph":"Km/h");let x=s(e,0,!1),I=l(x,a);m.src=I.icon,document.body.style.backgroundImage=`url('${I.backgroundImage}')`;const L=document.createElement("h2");L.textContent=x;const j=document.createElement("p");j.textContent="Uv Index: "+g.values.uvIndexAvg;const S=document.createElement("p");S.textContent="Chances of Rain: "+g.values.precipitationProbabilityAvg+"%";const M=document.createElement("p");return M.textContent="Humidity: "+g.values.humidityAvg+"%",d.append(m,f,L,p,b),u.append(y,M,E,S,j),c.append(d,u),n.appendChild(c),c}(e),async function(e){console.log(e);const n=document.getElementById("forecast");n.innerHTML=" ";const a=document.createElement("div");if(a.classList.add("forecastcardsdiv"),"daily"===c)for(let t=0;t<5;t++){let n=document.createElement("div"),c=new Date(e.timelines.daily[t].time),d=document.createElement("p");d.textContent=o[c.getDay()],n.classList.add("forecastcard");let u=document.createElement("img"),m=document.createElement("p"),g=document.createElement("p"),h=l(s(e,t,!1),!1);u.src=h.icon;let y=e.timelines.daily[t].values.temperatureMax,p=e.timelines.daily[t].values.temperatureMin;"fahrenheit"===i&&(y=r(y),p=r(p)),g.textContent=Math.round(y)+("fahrenheit"===i?"Fº":"Cº"),m.textContent=Math.round(p)+("fahrenheit"===i?"Fº":"Cº"),n.append(d,u,m,g),a.appendChild(n)}else if("hourly"===c){let n=1,o=Number(t.toString().slice(0,2))+1;console.log("currenthournew:"+o);for(let t=0;t<6;t++){console.log(t);let c=document.createElement("div"),d=document.createElement("p");d.textContent=o+":00",c.classList.add("forecastcard");let u=document.createElement("img"),m=document.createElement("p"),g=l(s(e,n,!0),!1);u.src=g.icon;let h=e.timelines.hourly[n].values.temperature;if("fahrenheit"===i&&(h=r(h)),m.textContent=Math.round(h)+("fahrenheit"===i?"Fº":"Cº"),c.append(d,u,m),a.appendChild(c),n+=4,o<24&&(o+=4),o>=24)switch(o){case 24:o=0;break;case 25:o=1;break;case 26:o=2;break;case 27:o=3}}}n.appendChild(a)}(e)}catch(e){console.error(e)}}(u,u.location.lat,u.location.lon)}catch(e){console.error(e),alert('Sorry, "too many" requests within an hour for this free tier API :) sponsor me and I will get the premium one so you can see if it will rain tomorrow. Or try again in some minutes.')}}const o=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];let a=!1,i="celsius",c="hourly";function r(e){return 9*e/5+32}function s(e,t,n){let o,a,i,c,r;return console.log("future features"+t+n),n?n&&(o=e.timelines.hourly[t].values,a=o.precipitationProbability,r=o.rainIntensity,i=o.cloudCover,c=o.snowIntensity):(o=e.timelines.daily[t].values,a=o.precipitationProbabilityAvg,r=o.rainIntensityAvg,i=o.cloudCoverAvg,c=o.snowIntensityAvg),a>50&&r>.55?"Storm":a>50&&r<.5?"Rain":i<25?"Clear":i>25&&i<50?"Partly Cloudy":a>50&&c>0?"Snow":i>50?"Cloudy":"unknown"}function l(e,t){const n={Rain:{background:t?"night-rain.jpg":"day-rain.jpg",icon:t?"wi-night-rain.svg":"wi-day-rain.svg"},Clear:{background:t?"clearest-night.jpg":"clear.jpg",icon:t?"wi-night-clear.svg":"wi-day-sunny.svg"},Cloudy:{background:t?"night-cloudy.jpg":"blue-cloudy.jpg",icon:t?"wi-night-cloudy.svg":"wi-cloudy.svg"},Snow:{background:t?"night-snow.jpg":"snow.jpg",icon:t?"wi-night-snow.svg":"wi-snow.svg"},Storm:{background:"storm.jpg",icon:t?"wi-night-storm-showers.svg":"wi-thunderstorm.svg"},"Partly Cloudy":{background:t?"night-partly.jpg":"partly-cloudy.jpg",icon:t?"wi-night-partly-cloudy.svg":"wi-day-sunny-overcast.svg"}};let o=n[e]||n.Clear;return{backgroundImage:`../src/images/backgrounds/${o.background}`,icon:`../src/images/weather-icons-master/svg/${o.icon}`}}const d=document.querySelector(".switch-input"),u=document.getElementById("location-input"),m=document.getElementById("magnifying"),g=document.getElementById("hourly-button"),h=document.getElementById("daily-button");let y="barcelona";window.addEventListener("load",(()=>{n(y)})),m.addEventListener("click",(()=>(console.log("glass clicked"),y=u.value,n(y),y))),d.addEventListener("click",(()=>{i="fahrenheit",n(y)})),g.addEventListener("click",(()=>{"daily"===c&&(c="hourly",g.classList.add("active"),h.classList.remove("active"),n(y))})),h.addEventListener("click",(()=>{"hourly"===c&&(c="daily",h.classList.add("active"),g.classList.remove("active"),n(y))})),navigator.geolocation.getCurrentPosition((e=>{console.log(e),function(e){fetch(`https://us1.locationiq.com/v1/reverse?key=pk.f37b37fa95ad947d134bbcff6585b6d9&lat=${e.coords.latitude}&lon=${e.coords.longitude}&format=json`).then((e=>e.json())).then((function(e){return console.log(e),y=e.address.postcode,n(y),y})).catch((e=>console.log(e)))}(e)}),(e=>{console.log(e)}))})();